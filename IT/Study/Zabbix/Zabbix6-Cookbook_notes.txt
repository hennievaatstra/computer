Zabbix 6 I Infrastructure Monitoring
Cookbook
Second Edition
Nathan Liefting | Brian van Baekel

These notes follow the RedHat based examples

Chapter 1: Installing Zabbix and getting start using the frontend

How to do it:
1. add Zabbix 6.0 repository to the server
    rpm -Uvh <https://repo>
    dnf clean all
2. add the MariaDB repository to the server
    wget <https://repo_setup>
    chmod +x <repo_setup>
    ./ <repo_setup>
3. install and enable mariadb
    dnf install mariadb-server
    systemctl enable--now mariadb
4. secure the mariadb installation
    /usr/bin/mariadb-secure-installation
5. install Zabbix server with MySQL support
    dnf install zabbix-server-mysql zabbix-sql-scripts
6. create Zabbix database
    mysql -u root -p
    create database zabbix character set utf8mb4 collate utf8mb4_bin;
    create user zabbix@localhost identified by 'password';
    grant all privileges on zabbix.* to zabbix@localhost identified by 'password';
    flush privileges;
    quit
7. import Zabbix database scheme
    zcat /usr/share/doc/zabbix-sql-scripts/mysql/server.sql.gz | mysql -u root -p zabbix

Configuring the Zabbix server
1. set db settings:
    vi /etc/zabbix/zabbix_server.conf
    DBName=zabbix
    DBUser=zabbix
    DBPassword=password
2. start Zabbix server
    systemctl enable --now zabbix-server
3. check status
    systemctl status zabbix-server

A complete Zabbix stack consists of at least:
- a database [MySQL, PostgreSQl or Oracle]
- a Zabbix server
- Apache or Nginx running the frontend with PHP7.2+ [php8 not supported]

Configuring the Zabbix frontend
1. install required packages
    dnf install zabbix-web-mysql zabbix-apache-conf
2. restart and enable zabbix components
    systemctl enabled httpd php-fpm
    systemctl restart zabbix-server httpd php-fpm
3. browse to frontend
    http://<your_server_ip>/zabbix

Enabling Zabbix server high availability
- cannot do loadbalancing yet
- setting up cluster nodes in same way as any new zabbix server
- will need some new config parameters:
  HANodeName=<node1>
  NodeAddress=<node1 IP>
  HANodeName=<node2>
  NodeAddress=<node2 IP>

Setting up Apache for HighAvailability
- is basically 'keepalived'
  dnf install keepalived
  vi /etc/keepalived/keepalived.conf

TIP:
When using HTTP/LDAP/SAML for authentication:
- it's still needed to add useraccount internally
- use same username as the 'remote' username

Chapter 2: Getting things ready with Zabbix User Management

The entire permission system is based on what user group(s0 and user role(s0 you are part of
- first create group
- then create user, added to the group

Chapter 3: Setting up Zabbix monitoring
